<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Collapscension</title>
    <!--Including Poppins...-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body
        {
            font-family:"Cascadia Mono",sans-serif;
            background-color:black;
            color:limegreen;
            min-height:100vh;
        }
        h1
        {
            text-align:center;
            font-family:"Poppins","Cascadia Mono",sans-serif;
            background-color:black;
        }
        h2{color:lightgreen;}
        button
        {
            font-family:"Cascadia Code",sans-serif;
            color:white;
            background-color:darkgray;
            transition:all 0.4s ease;
        }
        button:hover
        {
            box-shadow:0 0 3px white,0 0 7px silver;
            transform:scale(1.2);
        }
        button:active
        {
            transform:scale(0.9);
        }
        .build
        {
            background-color:#354;
            color:#fff;
            display:none;
        }
        .glowtext{text-shadow:0 0 3px white,0 0 7px silver}
        .upg
        {
            background-color:#345;
            color:#fff;
            display:none;
        }
        .upg-completed
        {
            display:inline;
            background-color:lime;
            color:navy;
            pointer-events:none;
            cursor:not-allowed;
        }
        .tab-link
        {
            font-family:"Poppins","Cascadia Mono",sans-serif;
            padding:10px 20px;
            background-color:ivory;;
            text-decoration:none;
            color:black;
        }
        .tab-content
        {
            display:none;
        }
        .tab-content:target
        {
            display:block;
        }
        .bg
        {
            background:linear-gradient(rgba(0,5,15,0.4),rgba(0,5,15,0.4)),url('logo.png');
            background-size:cover;
            background-position:center;
            background-repeat:no-repeat;
        }
        ::-webkit-scrollbar-track
        {
            background:black;
        }
    </style>
</head>
<body>
    <div class="bg">
        <h1 id="0">Collapscension</h1>
        <noscript>
            <h2 style="color:red;"></&lt;/&gt;x</h2>
            <p>Your Js isn't allowed</p>
            <p>Please Enabled Js!</p>
        </noscript>
        <div>
            <a id="12"href="#p12" class="tab-link">Play/Standard</a>
            <a id="13"href="#p13" class="tab-link" style="background-color:aquamarine;display:none;">Research</a>
        </div><br>
        <script src="break_eternity.js"></script>
        <br><h2 class="glowtext"id="1"style="display:none;"></h2>
        <div id="p12" class="tab-content">
            <button style="border-radius:123px;width:100px;height:100px;"onclick="gameStart()"id="4">+1 point</button>
            <br><button id="2" class="build" onclick="addAtom_h()"></button>
            <br><button id="6" class="build" onclick="addAtom_2()"></button>
            <br><button id="7" class="build" onclick="addAtom_3()"></button>
            <br><button id="9" class="build" onclick="addm()"></button>
            <br><button id="10" class="build" onclick="addM()"></button>
            <p id="3">Current Version:V0.5.2β</p>
            <div style="background-color:navy;width:210px;">
                <button onclick="
                    let saveData=prompt('Import:');
                    Import(saveData);
                    alert('Game Imported!')
                ">Import(prompt)</button>
                <button onclick="
                    Ex=Export();
                    navigator.clipboard.writeText(JSON.stringify(Ex));
                    alert('Game Exported!')
                ">Export to you clipboard</button>
                <button style="background-color:crimson;" onclick="RESET()">RESET THE GAME</button>
            </div>
            <br><button class="upg" onclick="buyH_2()"id="5">
                Upgrade:buy hydrogen₂(H₂):x2 point gain|Cost:100 Points</button>
            <br><button class="upg" onclick="buybp()"id="8">
                Repeatable Base Purchase gain(Lv.0)|Cost:2,000.00 Points</button>
        </div>
        <div id="p13" class="tab-content" style="background-color:#00341f;">
            <h2 id="11" class="glowtext" style="color:aquamarine;">You Have 0.00 Cell</h2>
            <p id="14">Your Cell will duplicate until 0.00 Cell(base at life)</p>
            <br><button class="upg" onclick="buyciv1()"id="15">
                1st Civilization Upgrade:Use Tools(x3 Point gain)|Cost:1,428,571 Points</button>
            <br><button class="upg" onclick="buyciv2()"id="16">
                Upgrade:Agricultural(amino acid/base pair gain base at Cells)|Cost:3 million Points</button>
            <br><button class="upg" onclick="buyciv3()"id="17">
                Upgrade:Calender(atom gain base at Time played)|Cost:10 million Points</button>
            <br><button class="upg" onclick="buyciv4()"id="18">
                Repeatable Expanded Purchase gain(Also Called Civ.Countries,Lv.0)|Cost:40,000,000 Points</button>
        </div>
    </div>
    <script>
        const _pt0=document.getElementById(0);
        const pt1=document.getElementById(1);
        const pt2=document.getElementById(2);
        const pt3=document.getElementById(3);
        const pt4=document.getElementById(4);
        const pt5=document.getElementById(5);
        const pt6=document.getElementById(6);
        const pt7=document.getElementById(7);
        const pt8=document.getElementById(8);
        const pt9=document.getElementById(9);
        const pt10=document.getElementById(10);
        const pt11=document.getElementById(11);
        const pt12=document.getElementById(12);
        const pt13=document.getElementById(13);
        const pt14=document.getElementById(14);
        const pt15=document.getElementById(15);
        const pt16=document.getElementById(16);
        const pt17=document.getElementById(17);
        const pt18=document.getElementById(18);
        const realSec=1/60;
        const SAVE_KEY="Collapscension/Stonelee";
        let Point=new Decimal("-1");
        let Ptspeed=new Decimal("0");
        let GpointMult=new Decimal("1");
        let pointMult=new Decimal("1");
        let atommult=new Decimal("1");
        let molemult=new Decimal("1");
        let Hmult=new Decimal("1");
        let mult2=new Decimal("1");
        let mult3=new Decimal("1");
        let H=new Decimal("0");
        let CorNorO=new Decimal("0");
        let others=new Decimal("0");
        let smallMolecule=new Decimal("0");
        let bigMolecule=new Decimal("0");
        let pH=new Decimal("0");
        let pCorNorO=new Decimal("0");//p means purchased bulidings
        let pothers=new Decimal("0");
        let psmallMolecule=new Decimal("0");
        let pbigMolecule=new Decimal("0");
        let gainH=new Decimal("0.1");
        let gainCorNorO=new Decimal("1.5");
        let gainothers=new Decimal("11.8");
        let gainsmall=new Decimal("0");
        let gainbig=new Decimal("0");
        let priceH=new Decimal("4");
        let price2=new Decimal("150");
        let price3=new Decimal("1234.56");
        let price4=new Decimal("1e4");
        let price5=new Decimal("1e5");
        let bPurchaseGainPrice=new Decimal("2000");
        let epPrice=new Decimal("4e7");
        let Tickesplayed=new Decimal("0");
        let Cell=new Decimal("1");
        let Life=new Decimal("0");
        let Upgrades=
        {
            H_2:0,
            bPurchaseLevel:new Decimal(0),
            civ1:0,
            civ2:0,
            civ3:0,
            civ4:new Decimal(0)
        }
        let maxLevels=
        {
            H_2:1,
            bPurchaseLevel:new Decimal(10),
            civ1:1,
            civ2:1,
            civ3:1,
            civ4:new Decimal(5)
        }
        const delay=(ms)=>new Promise(resolve=>setTimeout(resolve,ms));
        function gameStart()//It is click func:D
        { 
            Point=Point.plus(pointMult).plus(Ptspeed.mul(1/4));
            pt1.style.display="inline";
            update();
        }
        function preupdt()
        {
            pointMult=GpointMult;
            if(Upgrades.civ2)molemult=new Decimal(Cell.pow(0.05))
            if(Upgrades.civ3)atommult=new Decimal((Tickesplayed.plus(10)).log10())
            gainH=Upgrades.bPurchaseLevel.mul(0.05).mul(Scap(pH)).plus(1).mul(0.1).mul(Upgrades.civ4.mul(0.01).plus(1).pow(Scap(pH)));
            gainCorNorO=Upgrades.bPurchaseLevel.mul(0.05).mul(Scap(pCorNorO)).plus(1).mul(1.5).mul(Upgrades.civ4.mul(0.01).plus(1).pow(Scap(pCorNorO)));
            gainothers=Upgrades.bPurchaseLevel.mul(0.05).mul(Scap(pothers)).plus(1).mul(1.5).mul(Upgrades.civ4.mul(0.01).plus(1).pow(Scap(pothers)));
            gainsmall=Upgrades.bPurchaseLevel.mul(0.05).mul(Scap(psmallMolecule)).plus(1).mul(0.1).mul(Upgrades.civ4.mul(0.01).plus(1).pow(Scap(psmallMolecule)));
            gainbig=Upgrades.bPurchaseLevel.mul(0.05).mul(Scap(pbigMolecule)).plus(1).mul(0.01).mul(Upgrades.civ4.mul(0.01).plus(1).pow(Scap(pbigMolecule)));
            pt1.textContent=`You have ${Format(Point)} Points`;
            Ptspeed=H.mul(gainH).plus(CorNorO.mul(gainCorNorO)).plus(others.mul(gainothers));
            Ptspeed=Ptspeed.mul(pointMult);   
        }
        function lotsupdt()
        {
            pt2.style.display="inline";
            pt2.textContent=`You have ${Format(H)} Hydrogens,every Hydrogens+ ${Format(pointMult.mul(gainH))} speed!
            Buy a single Hydrogen|Cost:${Format(priceH)} Points`
            pt3.textContent=`(${Format(Ptspeed)}/s,Click will +25% of point speed)`;
            pt4.textContent=`+${Format(pointMult.plus(Ptspeed.mul(1/4)))} point`
            pt6.textContent=`You have ${Format(CorNorO)} Carbon or Nitrogen or Oxygon,
            every this+ ${Format(pointMult.mul(gainCorNorO))} speed!(Cost:${Format(price2)})`
            pt7.textContent=`You have ${Format(others)} Other atoms,
            every this+ ${Format(pointMult.mul(gainothers))} speed!(Cost:${Format(price3)})`
            pt8.textContent=`Repeatable Base Purchase gain(Lv.${intFormat(Upgrades.bPurchaseLevel)},
            +${Format(Upgrades.bPurchaseLevel.mul(5))}%)|Cost:${Format(bPurchaseGainPrice)} Points`
            pt9.textContent=`You have ${Format(smallMolecule)} Amino acid/base pair,
            every this+ ${Format(gainsmall.mul(atommult))} atom speed!(Cost:${Format(price4)})`
            pt10.textContent=`You have ${Format(bigMolecule)} protein/DNA,
            every this+ ${Format(gainbig.mul(molemult))} Amino acid/base pair speed!(Cost:${Format(price5)})`
            pt11.textContent=`You have ${Format(Cell.sub(1))} Cells and ${Format(Life)} Lifes.`;
            pt14.textContent=`Your Cell will duplicate until ${Format(Life.pow(1.5).plus(1))} Cell(base at life)`
            pt18.textContent=`Repeatable Expanded Purchase gain(Civ.Countries Lv.${intFormat(Upgrades.civ4)},
            +${Format(Upgrades.civ4.mul(1))}%)|Cost:${Format(epPrice)} Points`
        }
        function update()
        {
            preupdt();
            if(Decimal.cmp(Point,new Decimal(3))>=0)lotsupdt();
            if(Decimal.cmp(H,new Decimal(2))>=0&&Upgrades.H_2==0)
            {
                pt5.className="upg"
                pt5.style.display="inline"
            }else if(Upgrades.H_2==maxLevels.H_2)pt5.className="upg-completed";
            else pt5.className="upg";
            if(Decimal.cmp(H,new Decimal(2))>=0)pt6.style.display="inline";
            if(Decimal.cmp(Point,new Decimal(987))>=0)
            {
                pt7.style.display="inline";
                if(Decimal.cmp(Upgrades.bPurchaseLevel,maxLevels.bPurchaseLevel)<0)
                {
                    pt8.className="upg";
                    pt8.style.display="inline"
                }
                else pt8.className="upg-completed";
            }
            if(Decimal.cmp(Point,new Decimal(3000))>=0)
            {
                pt9.style.display="inline";
                pt10.style.display="inline";
            }
            if(Decimal.cmp(bigMolecule,1)>=0)
            {
                pt11.style.display="inline";
                pt13.style.display="inline";
                if(Decimal.cmp(Upgrades.civ1,maxLevels.civ1)<0)
                {
                    pt15.className="upg";
                    pt15.style.display="inline"
                }
                else pt15.className="upg-completed";
            }
            if(Decimal.cmp(bigMolecule,3)>=0)
            {   
                if(Decimal.cmp(Upgrades.civ2,maxLevels.civ2)<0)
                {
                    pt16.className="upg";
                    pt16.style.display="inline"
                }
                else 
                {
                    pt16.className="upg-completed";
                    pt16.textContent=`Upgrade:Agricultural|Current:x${Format(Cell.pow(0.05))}`
                }
            }
            if(Decimal.cmp(bigMolecule,5)>=0)
            {   
                if(Decimal.cmp(Upgrades.civ3,maxLevels.civ3)<0)
                {
                    pt17.className="upg";
                    pt17.style.display="inline"
                }
                else 
                {
                    pt17.className="upg-completed";
                    pt17.textContent=`Upgrade:Calender|Current:x${Format((Tickesplayed.plus(10)).log10())}`
                }
            }
            if(Decimal.cmp(bigMolecule,7)>=0)
            {   
                if(Decimal.cmp(Upgrades.civ4,maxLevels.civ4)<0)
                {
                    pt18.className="upg";
                    pt18.style.display="inline"
                }
                else 
                {
                    pt18.className="upg-completed";
                }
            }
        }
        function addAtom_h()
        {
            if(Decimal.cmp(Point,priceH)>=0)
            {
                Point=Point.minus(priceH);
                H=H.plus(1);
                pH=pH.plus(1);
                priceH=priceH.mul(1.2);
                update();
            }
        }
        function Format(p)
        {
            if(p.isNaN)return "???"
            if(!p.isFinite())return "Ω"
            if(Decimal.cmp(p,1e6)<0)return p.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",");
            if(Decimal.cmp(p,1e9)<0)return p.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",");
            else if(Decimal.cmp(p,new Decimal("ee4"))<0)
            {
                return `${(10**(p.log10().toNumber()%1)).toFixed(2)}e${Math.floor(p.log10().toNumber())}`;
            }
            else if(Decimal.cmp(p,new Decimal("eeeee9"))<0)return `e${Format(p.log10())}`;
            else return `${Math.log10(p.mag).toFixed(2)}F${intFormat(new Decimal(p.layer+1))}`;
        }
        function intFormat(p)
        {
            if(Decimal.cmp(p,1e9)<0)return p.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",");
            else return Format(p)
        }
        async function mainLoop()
        {
            while(1)
            {
                await delay(realSec*1000);
                update();
                Runtick(new Decimal(1))
            }
        }
        function Runtick(timespeed)
        {
            var inSec=timespeed.mul(realSec)
            Point=Point.plus(Ptspeed.mul(inSec));
            H=H.plus(gainsmall.mul(smallMolecule).mul(inSec).mul(atommult));
            CorNorO=CorNorO.plus(gainsmall.mul(1/10).mul(smallMolecule).mul(inSec).mul(atommult));
            others=others.plus(gainsmall.mul(1/100).mul(smallMolecule).mul(inSec).mul(atommult));
            smallMolecule=smallMolecule.plus(gainbig.mul(bigMolecule).mul(inSec).mul(molemult))
            Life=Life.plus(bigMolecule.mul(inSec))
            if(Decimal.cmp(Cell,Life.pow(1.5).plus(1))==-1)Cell=Cell.mul(1.001).pow(timespeed);
            Tickesplayed=Tickesplayed.plus(1);
        }
        function buyH_2()
        {
            if(Decimal.cmp(Point,100)>=0)
            {
                Point=Point.minus(100);
                GpointMult=GpointMult.mul(2);
                update();
                Upgrades.H_2=1;
            }
        }
        function addAtom_2()
        {
            if(Decimal.cmp(Point,price2)>=0)
            {
                Point=Point.minus(price2);
                CorNorO=CorNorO.plus(1);
                pCorNorO=pCorNorO.plus(1);
                price2=price2.mul(1.2);
                update();
            }
        }
        function addAtom_3()
        {
            if(Decimal.cmp(Point,price3)>=0)
            {
                Point=Point.minus(price3);
                others=others.plus(1);
                pothers=pothers.plus(1);
                price3=price3.mul(1.2);
                update();
            }
        }
        function buybp()
        {
            if(Decimal.cmp(Point,bPurchaseGainPrice)>=0)
            {
                Point=Point.minus(bPurchaseGainPrice);
                Upgrades.bPurchaseLevel=Upgrades.bPurchaseLevel.plus(1);
                bPurchaseGainPrice=bPurchaseGainPrice.mul(10);
                update();
            }
        }
        function addm()
        {
            if(Decimal.cmp(Point,price4)>=0)
            {
                Point=Point.minus(price4);
                smallMolecule=smallMolecule.plus(1);
                psmallMolecule=psmallMolecule.plus(1);
                price4=price4.mul(1.2);
                update();
            }
        }
        function addM()
        {
            if(Decimal.cmp(Point,price5)>=0)
            {
                Point=Point.minus(price5);
                bigMolecule=bigMolecule.plus(1);
                pbigMolecule=pbigMolecule.plus(1);
                price5=price5.mul(1.2);
                update();
            }
        }
        function buyciv1()
        {
            if(Decimal.cmp(Point,1428571)>=0)
            {
                Point=Point.minus(1428571);
                GpointMult=GpointMult.mul(3);
                update();
                Upgrades.civ1=1;
            }
        }
        function buyciv2()
        {
            if(Decimal.cmp(Point,3e6)>=0)
            {
                Point=Point.minus(3e6);
                update();
                Upgrades.civ2=1;
            }
        }
        function buyciv3()
        {
            if(Decimal.cmp(Point,1e7)>=0)
            {
                Point=Point.minus(1e7);
                update();
                Upgrades.civ3=1;
            }
        }
        function buyciv4()
        {
            if(Decimal.cmp(Point,epPrice)>=0)
            {
                Point=Point.minus(epPrice);
                update();
                Upgrades.civ4=Upgrades.civ4.plus(1);
                epPrice=epPrice.mul(21);
            }
        }
        function Scap(num)
        {
            if(Decimal.cmp(num,100)>=0)
            {
                return num.minus(100).pow(0.5).plus(100)
            }
            return num
        }
        function Export()
        {
            return{
                Point:Point.toString(),
                Ptspeed:Ptspeed.toString(),
                pointMult:pointMult.toString(),
                GpointMult:pointMult.toString(),
                atommult:atommult.toString(),
                molemult:molemult.toString(),
                Hmult:Hmult.toString(),
                mult2:mult2.toString(),
                mult3:mult3.toString(),
                H:H.toString(),
                CorNorO:CorNorO.toString(),
                others:others.toString(),
                smallMolecule:smallMolecule.toString(),
                bigMolecule:bigMolecule.toString(),
                pH:pH.toString(),
                pCorNorO:pCorNorO.toString(),
                pothers:pothers.toString(),
                psmallMolecule:psmallMolecule.toString(),
                pbigMolecule:pbigMolecule.toString(),
                gainH:gainH.toString(),
                gainCorNorO:gainCorNorO.toString(),
                gainothers:gainothers.toString(),
                gainsmall:gainsmall.toString(),
                gainbig:gainbig.toString(),
                priceH:priceH.toString(),
                price2:price2.toString(),
                price3:price3.toString(),
                price4:price4.toString(),
                price5:price5.toString(),
                Cell:Cell.toString(),
                Life:Life.toString(),
                Tickesplayed:Tickesplayed.toString(),
                bPurchaseGainPrice:bPurchaseGainPrice.toString(),
                Upgrades:
                {
                    H_2:Upgrades.H_2,
                    bPurchaseLevel:Upgrades.bPurchaseLevel.toString(),
                    civ1:Upgrades.civ1,
                    civ2:Upgrades.civ2,
                    civ3:Upgrades.civ3,
                    civ4:Upgrades.civ4.toString()
                }
            };
        }
        function Import(saveData)
        {
            if(!saveData)return;
            try
            {
                saveData=JSON.parse(saveData);
                Point=new Decimal(saveData.Point || "0");
                Ptspeed=new Decimal(saveData.Ptspeed || "0");
                GpointMult=new Decimal(saveData.GpointMult || "1");
                pointMult=new Decimal(saveData.pointMult || "1");
                atommult=new Decimal(saveData.atommult || "1");
                molemult=new Decimal(saveData.molemult || "1");
                mult2=new Decimal(saveData.mult2 || "1");
                mult3=new Decimal(saveData.mult3 || "1");
                H=new Decimal(saveData.H || "0");
                CorNorO=new Decimal(saveData.CorNorO || "0");
                others=new Decimal(saveData.others || "0");
                smallMolecule=new Decimal(saveData.smallMolecule || "0");
                bigMolecule=new Decimal(saveData.bigMolecule || "0");
                pH=new Decimal(saveData.pH || "0");
                pCorNorO=new Decimal(saveData.pCorNorO || "0");
                pothers=new Decimal(saveData.pothers || "0");
                psmallMolecule=new Decimal(saveData.psmallMolecule || "0");
                pbigMolecule=new Decimal(saveData.pbigMolecule || "0");
                gainH=new Decimal(saveData.gainH || "0.1");
                gainCorNorO=new Decimal(saveData.gainCorNorO || "1.5");
                gainothers=new Decimal(saveData.gainothers || "11.8");
                gainsmall=new Decimal(saveData.gainsmall || "0");
                gainbig =new Decimal(saveData.gainbig || "0");
                priceH=new Decimal(saveData.priceH || "4");
                price2=new Decimal(saveData.price2 || "150");
                price3=new Decimal(saveData.price3 || "1234.56");
                price4=new Decimal(saveData.price4 || "1e4");
                price5=new Decimal(saveData.price5 || "1e5");
                Cell=new Decimal(saveData.Cell || "1");
                Life=new Decimal(saveData.Life || "0");
                Tickesplayed=new Decimal(saveData.Tickesplayed || "0");
                bPurchaseGainPrice=new Decimal(saveData.bPurchaseGainPrice || "2000");
                epPrice=new Decimal(saveData.bPurchaseGainPrice || "4e7");
                Upgrades.H_2=saveData.Upgrades?.H_2 || 0;
                Upgrades.bPurchaseLevel=new Decimal(saveData.Upgrades?.bPurchaseLevel || "0");
                Upgrades.civ1=saveData.Upgrades?.civ1 || 0;
                Upgrades.civ2=saveData.Upgrades?.civ2 || 0;
                Upgrades.civ3=saveData.Upgrades?.civ3 || 0;
                Upgrades.civ4=new Decimal(saveData.Upgrades?.civ4 || "0");
                console.log("Save Imported");
            }
            catch(e)
            {
                console.error("SavingError!",e);
                alert("Looks Like That's a Saving Error...");
            }
        }
        function loading()
        {
            try
            {
                const saveData=localStorage.getItem(SAVE_KEY);
                if(saveData) Import(saveData);
                update(); 
                gameStart();
                console.log("Save Loaded");
            }
            catch(e)
            {
                console.error("LoadingError", e);
            }
        }
        function autoSave()
        {
            try
            {
                const saveData = JSON.stringify(Export());
                localStorage.setItem(SAVE_KEY, saveData);
                console.log("Game Saved!", new Date().toLocaleString());}
            catch(e)
            {
                console.error("AutoSaveError",e);
            }
        }
        function RESET()
        {
            if(confirm("REALLY RESET YOUR GAME?THAT'S NO REWARD!")&&confirm("REALLY?²(AGAIN)"))
            {
                localStorage.removeItem(SAVE_KEY);
                location.reload();
            }
        }
        function run()
        {
            let hue=123;
            setInterval(()=>{localStorage.setItem("Collapscension/Stonelee",JSON.stringify(Export()))},15000);
            setInterval(()=>{hue+=0.2;hue%=360;_pt0.style.color=`hsl(${hue},75%,75%)`;},realSec);//Rainbow!
            loading();
            mainLoop();
        }
        run();//Game start from there not from gameStart()
    </script>
</body>
</html>
